#FROM mongo:4.4.18
# 4.4.18 (or maybe simply 4.4.X) is the latest Mongo version that can work without AVX
# https://www.mongodb.com/docs/upcoming/release-notes/4.4/#4.4.18---nov-21--2022
FROM mongo:6.0

# Set an environment variable with the directory
# where we'll be running the app
ENV APP /install

# Create the directory and instruct Docker to operate
# from there from now on
RUN mkdir $APP
WORKDIR $APP

RUN apt-get update
RUN apt-get install -y p7zip-full

COPY ./docker/files/mongodb/install.sh /docker-entrypoint-initdb.d/install.sh

RUN sed -i -e 's/\r$//' /docker-entrypoint-initdb.d/install.sh

RUN ["chmod", "+x", "/docker-entrypoint-initdb.d/install.sh"]

COPY ./docker/files/mongodb/db_dump_part* ./

RUN ["chown", "mongodb:", "-R", "/install"]

EXPOSE 27017
